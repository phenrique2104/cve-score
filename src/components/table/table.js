import "./table.style.css"
import React from 'react';
import Modal from 'react-modal';


export const Table = ({ dataTable }) => {
    console.log(dataTable)
    const [modalIsOpen, setIsOpen] = React.useState(false);
    const [summary, setSummary] = React.useState();



    const customStyles = {
        content: {
            top: '50%',
            left: '50%',
            right: 'auto',
            bottom: 'auto',
            marginRight: '-50%',
            width: '60%',
            transform: 'translate(-50%, -50%)',
        },
    };

    function closeModal() {
        setIsOpen(false);
    }

    function openModal() {
        console.log(summary)
        setIsOpen(true);
    }

    return (
        <>
            {dataTable ?
                <div className="data">

                    <span className="span-table">
                        <table className="data-table">
                            <caption className="caption">Overview</caption>
                            <thead>
                                <tr>
                                    <th>CWE</th>
                                    <th>Summary</th>
                                    <th>Modified</th>
                                    <th>Acess authentication</th>
                                    <th>Acess Complexity</th>
                                    <th>Acess Vector</th>
                                    <th>Score Impact</th>
                                </tr>

                            </thead>
                            <tbody>
                                <tr>
                                    <td>{dataTable?.cwe}</td>
                                    <td>{dataTable?.summary}</td>
                                    <td>{dataTable?.Modified}</td>
                                    <td>{dataTable?.access?.authentication}</td>
                                    <td>{dataTable?.access?.complexity}</td>
                                    <td>{dataTable?.access?.vector}</td>
                                    <td>{dataTable?.impactScore3}</td>
                                </tr>

                            </tbody>

                        </table>


                    </span>
                    <span className="span-table table-capec">
                        <table className="data-table">
                            <caption className="caption">Related Capec</caption>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Severity</th>
                                    <th>Name</th>
                                    <th>Summary</th>

                                </tr>

                            </thead>
                            <tbody>

                                <tr>
                                    <td>{dataTable.capec[dataTable.capec.length - 1].id}</td>
                                    <td>{dataTable.capec[dataTable.capec.length - 1].typical_severity}</td>
                                    <td>{dataTable.capec[dataTable.capec.length - 1].name}</td>
                                    <td>
                                        <button className="button btn-summary" onClick={() => {
                                            setSummary(dataTable.capec[dataTable.capec.length - 1].summary)
                                            openModal()
                                        }}
                                        >
                                            click to view
                                        </button>
                                    </td>

                                </tr>
                                <tr>
                                    <td>{dataTable.capec[dataTable.capec.length - 2].id}</td>
                                    <td>{dataTable.capec[dataTable.capec.length - 2].typical_severity}</td>
                                    <td>{dataTable.capec[dataTable.capec.length - 2].name}</td>
                                    <td>
                                        <button className="button btn-summary" onClick={() => {
                                            setSummary(dataTable.capec[dataTable.capec.length - 2].summary)
                                            openModal()
                                        }}
                                        >
                                            click to view
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>{dataTable.capec[dataTable.capec.length - 3].id}</td>
                                    <td>{dataTable.capec[dataTable.capec.length - 3].typical_severity}</td>
                                    <td>{dataTable.capec[dataTable.capec.length - 3].name}</td>
                                    <td>
                                        <button className="button btn-summary" onClick={() => {
                                            setSummary(dataTable.capec[dataTable.capec.length - 3].summary)
                                            openModal()
                                        }}
                                        >
                                            click to view
                                        </button>
                                    </td>
                                </tr>


                            </tbody>

                        </table>
                    </span>

                    <Modal
                        isOpen={modalIsOpen}
                        onRequestClose={closeModal}
                        style={customStyles}
                        contentLabel="Example Modal"
                        ariaHideApp={false}
                    >
                        <button onClick={closeModal}>close</button>
                        <div>
                            {summary}
                        </div>

                    </Modal>

                    <button className="button btn-align"><span>GET SCORE</span></button>

                </div>

                : ""}


        </>
    )
}



